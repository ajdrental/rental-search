
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>아정당 렌탈 시트 뷰어</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; font-size: 12px; }
    th { background-color: #f2f2f2; }
    .search-bar { margin-bottom: 10px; }
    .search-bar input { padding: 8px; width: 300px; }
    .search-bar button { padding: 8px 12px; }
  </style>
</head>
<body>
  <h2>아정당 렌탈 시트 전체 보기</h2>
  <div class="search-bar">
    <input type="text" id="query" placeholder="상품명 또는 모델명 검색">
    <button onclick="search()">검색</button>
  </div>
  <div id="tableContainer">불러오는 중...</div>

  <script>
    function search() {
      const query = document.getElementById('query').value;
      google.script.run.withSuccessHandler(drawTable).searchAll(query);
    }

    function drawTable(data) {
      let html = '<table><thead><tr>';
      const header = data[0];
      for (let h of header) {
        html += `<th>${h}</th>`;
      }
      html += '</tr></thead><tbody>';
      for (let i = 1; i < data.length; i++) {
        html += '<tr>';
        for (let cell of data[i]) {
          html += `<td>${cell ?? ''}</td>`;
        }
        html += '</tr>';
      }
      html += '</tbody></table>';
      document.getElementById('tableContainer').innerHTML = html;
    }

    // 기본으로 전체 표시
    google.script.run.withSuccessHandler(drawTable).searchAll('');
  </script>
</body>
</html>
